// Get stats on ExploitGuard blocks - count events and machines per rule
MiscEvents
| where (ActionType startswith "ExploitGuard" or ActionType startswith "Asr") and ActionType endswith "Blocked"
| extend RuleId=extractjson("$.RuleId", AdditionalFields, typeof(string))
// Count total stats - count events and machines per rule
| summarize EventCount=count(), MachinesCount=dcount(ComputerName) by ActionType, RuleId

// View ExploitGuard audit events - but remove repeating events (e.g. multiple events with same machine, rule, file and process)
MiscEvents
| where (ActionType startswith "ExploitGuard" or ActionType startswith "Asr") and ActionType endswith "Audited"
| extend RuleId=extractjson("$.RuleId", AdditionalFields, typeof(string))
| summarize EventTime =max(EventTime) by ComputerName, ActionType,RuleId,FileName, FolderPath, InitiatingProcessCommandLine, InitiatingProcessFileName, InitiatingProcessFolderPath, InitiatingProcessId, SHA1 

