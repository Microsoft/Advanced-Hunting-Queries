// Query 1: Sample query to detect within the last 7 days If there are more then 3 failed logon authentications on high value assets.
// Update ComputerName to reflect your high value assets.
LogonEvents
// For questions @MiladMSFT on Twitter or milad.aslaner@microsoft.com
| where ComputerName in ("milad-wins","aydinyogav5")
| where EventTime > ago(7d) 
| where ActionType == "LogonFailed"
| summarize LogonFailures=dcount(EventTime) by ComputerName, StartDT=bin(EventTime, 60s), LogonType, InitiatingProcessCommandLine
| where LogonFailures > 3
| project LogonFailures, StartDT, EndDT = StartDT + 60s, ComputerName, LogonType, InitiatingProcessCommandLine
| sort by StartDT desc

// Query 2: Sample query to detect within the last 7 days If there are more then 3 failed logon authentications on all onboarded endpoints.
// For questions @MiladMSFT on Twitter or milad.aslaner@microsoft.com
| where EventTime > ago(7d) 
| where ActionType == "LogonFailed"
| summarize LogonFailures=dcount(EventTime) by ComputerName, StartDT=bin(EventTime, 60s), LogonType, InitiatingProcessCommandLine
| where LogonFailures > 3
| project LogonFailures, StartDT, EndDT = StartDT + 60s, ComputerName, LogonType, InitiatingProcessCommandLine
| sort by StartDT desc
